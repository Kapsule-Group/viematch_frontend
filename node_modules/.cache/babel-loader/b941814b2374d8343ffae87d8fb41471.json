{"ast":null,"code":"import _classCallCheck from \"/home/mydev/viebeg/backend/viebeg_backend2/4Com-viebeg-frontend-2089674220ab-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/mydev/viebeg/backend/viebeg_backend2/4Com-viebeg-frontend-2089674220ab-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/mydev/viebeg/backend/viebeg_backend2/4Com-viebeg-frontend-2089674220ab-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/mydev/viebeg/backend/viebeg_backend2/4Com-viebeg-frontend-2089674220ab-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/mydev/viebeg/backend/viebeg_backend2/4Com-viebeg-frontend-2089674220ab-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/mydev/viebeg/backend/viebeg_backend2/4Com-viebeg-frontend-2089674220ab-2/src/components/Auth/Login/Login.jsx\";\nimport React, { Component } from 'react';\nimport { Field, reduxForm } from 'redux-form';\nimport { connect } from 'react-redux';\nimport ReCAPTCHA from \"react-google-recaptcha\";\nimport { bindActionCreators } from 'redux';\nimport RenderField from \"../../HelperComponents/RenderField/RenderField\";\nimport DefaultButton from '../../Buttons/DefaultButton/DefaultButton';\nimport { Link } from 'react-router-dom';\nimport { postLogin } from '../../../actions/authActions';\nimport { resetErrorUsers } from '../../../actions/UserActions';\nvar SITE_KEY = \"6LfWmNQUAAAAAHjBqN29AftN2ntLZ5858Yi6M085\";\nvar recaptchaRef = React.createRef();\n\nvar Login = /*#__PURE__*/function (_Component) {\n  _inherits(Login, _Component);\n\n  function Login() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Login)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      reCaptcha: false,\n      loading: false\n    };\n\n    _this.submitForm = function (data) {\n      var _this$props = _this.props,\n          postLogin = _this$props.postLogin,\n          history = _this$props.history,\n          resetErrorUsers = _this$props.resetErrorUsers; // const recaptchaValue = recaptchaRef.current.getValue();\n\n      _this.setState({\n        loading: true\n      });\n\n      data.site = \"user\";\n      data.recaptcha = _this.state.recaptchaKey;\n      postLogin(data).then(function (res) {\n        if (res.payload && res.payload.status && res.payload.status === 200) {\n          localStorage.token = res.payload.data.token;\n          localStorage.email = res.payload.data.email;\n          localStorage.username = res.payload.data.username;\n          localStorage.role = res.payload.data.role;\n          resetErrorUsers();\n          history.push(\"/main/dashboard/\");\n        } else {\n          _this.setState({\n            loading: false,\n            reCaptcha: false\n          });\n\n          recaptchaRef.current.reset();\n        }\n      });\n    };\n\n    _this.onChange = function (key) {\n      _this.setState({\n        reCaptcha: true,\n        recaptchaKey: key\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          handleSubmit = _this$props2.handleSubmit,\n          submitting = _this$props2.submitting,\n          pristine = _this$props2.pristine,\n          valid = _this$props2.valid,\n          error_login = _this$props2.error_login,\n          resetErrorUsers = _this$props2.resetErrorUsers;\n      var _this$state = this.state,\n          reCaptcha = _this$state.reCaptcha,\n          loading = _this$state.loading;\n      return /*#__PURE__*/React.createElement(\"form\", {\n        onSubmit: handleSubmit(this.submitForm),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"auth-block_head\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 17\n        }\n      }, \"Sign in to VIEBEG\"), /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"auth-block_descriptions\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 17\n        }\n      }, \"Provide your credentials below\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"block_field\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 21\n        }\n      }, \"Email\"), /*#__PURE__*/React.createElement(Field, {\n        name: \"email\",\n        type: \"text\",\n        component: RenderField,\n        placeholder: \"Type here\\u2026\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"back_error\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 21\n        }\n      }, !!error_login && error_login.email)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"block_custom_field\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"block_field\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"password_reset\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 29\n        }\n      }, \"Password\"), /*#__PURE__*/React.createElement(Link, {\n        to: \"/auth/password-recovery/first-step\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 29\n        }\n      }, \"Forgot password?\")), /*#__PURE__*/React.createElement(Field, {\n        name: \"password\",\n        type: \"password\",\n        component: RenderField,\n        placeholder: \"Type here\\u2026\",\n        onChange: function onChange(e) {\n          return error_login ? resetErrorUsers() : e;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"back_error\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 25\n        }\n      }, !!error_login && error_login.password)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"captcha_block\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(ReCAPTCHA, {\n        theme: \"light\",\n        ref: recaptchaRef,\n        sitekey: SITE_KEY,\n        onChange: this.onChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"back_error\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 25\n        }\n      }, !!error_login && error_login.recaptcha))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"auth_btn_wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(DefaultButton, {\n        variant: \"contained\",\n        disabled: reCaptcha ? submitting || pristine || !valid : true,\n        loading: loading,\n        formAction: true,\n        type: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }\n      }, \"Sign in\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"info_auth\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 21\n        }\n      }, \"Don\\u2019t have a VIEBEG account yet?\"), /*#__PURE__*/React.createElement(Link, {\n        to: \"/auth/sign-up\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }\n      }, \"SIGN UP\")));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nvar validate = function validate(values) {\n  var errors = {};\n\n  if (!values.company) {\n    errors.company = 'Required';\n  } else if (values.company.length < 3) {\n    errors.company = 'Must be 3 characters or more';\n  }\n\n  if (!values.email) {\n    errors.email = 'Required';\n  } else if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,5}$/i.test(values.email)) {\n    errors.email = 'Invalid email';\n  }\n\n  if (!values.password) {\n    errors.password = 'Required';\n  } else if (values.password.length < 8) {\n    errors.password = 'Must be 8 characters or more';\n  }\n\n  if (!values.phone) {\n    errors.phone = 'Required';\n  }\n\n  if (!values.address) {\n    errors.address = 'Required';\n  }\n\n  return errors;\n};\n\nLogin = reduxForm({\n  form: 'LoginForm',\n  validate: validate\n})(Login);\n\nfunction mapStateToProps(state, props) {\n  return {\n    error_login: state.auth.error\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    postLogin: postLogin,\n    resetErrorUsers: resetErrorUsers\n  }, dispatch);\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Login);","map":{"version":3,"sources":["/home/mydev/viebeg/backend/viebeg_backend2/4Com-viebeg-frontend-2089674220ab-2/src/components/Auth/Login/Login.jsx"],"names":["React","Component","Field","reduxForm","connect","ReCAPTCHA","bindActionCreators","RenderField","DefaultButton","Link","postLogin","resetErrorUsers","SITE_KEY","recaptchaRef","createRef","Login","state","reCaptcha","loading","submitForm","data","props","history","setState","site","recaptcha","recaptchaKey","then","res","payload","status","localStorage","token","email","username","role","push","current","reset","onChange","key","handleSubmit","submitting","pristine","valid","error_login","e","password","validate","values","errors","company","length","test","phone","address","form","mapStateToProps","auth","error","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport { Field, reduxForm } from 'redux-form';\nimport {connect} from 'react-redux';\nimport ReCAPTCHA from \"react-google-recaptcha\";\nimport { bindActionCreators } from 'redux';\nimport RenderField from \"../../HelperComponents/RenderField/RenderField\";\nimport DefaultButton from '../../Buttons/DefaultButton/DefaultButton';\nimport { Link } from 'react-router-dom';\nimport { postLogin } from '../../../actions/authActions';\nimport { resetErrorUsers } from '../../../actions/UserActions';\n\n\n\nconst SITE_KEY = \"6LfWmNQUAAAAAHjBqN29AftN2ntLZ5858Yi6M085\";\n\nconst recaptchaRef = React.createRef();\n\nclass Login extends Component {\n\n    state = {\n        reCaptcha: false,\n        loading: false,\n    };\n\n    submitForm = (data) => {\n        const { postLogin, history, resetErrorUsers } = this.props;\n        // const recaptchaValue = recaptchaRef.current.getValue();\n        this.setState({loading: true});\n        data.site = \"user\";\n        data.recaptcha = this.state.recaptchaKey;\n        postLogin(data).then(res => {\n            if(res.payload && res.payload.status && res.payload.status === 200) {\n                localStorage.token = res.payload.data.token;\n                localStorage.email = res.payload.data.email;\n                localStorage.username = res.payload.data.username;\n                localStorage.role = res.payload.data.role;\n                resetErrorUsers();\n                history.push(`/main/dashboard/`)\n            } else {\n                this.setState({ loading: false, reCaptcha: false });\n                recaptchaRef.current.reset();\n            }\n        })\n    };\n\n    onChange= (key) =>{\n        this.setState({\n            reCaptcha: true,\n            recaptchaKey: key\n        })\n    };\n\n    render(){\n        const {handleSubmit, submitting, pristine, valid, error_login, resetErrorUsers } = this.props;\n        const { reCaptcha, loading } = this.state;\n        return (\n            <form onSubmit={handleSubmit(this.submitForm)}>\n                <h3 className=\"auth-block_head\">Sign in to VIEBEG</h3>\n                <h3 className=\"auth-block_descriptions\">Provide your credentials below</h3>\n                <div className=\"block_field\">\n                    <span>Email</span>\n                    <Field name=\"email\"\n                           type=\"text\"\n                           component={RenderField}\n                           placeholder=\"Type here…\"\n                    />\n                    <span className='back_error'>{!!error_login && error_login.email}</span>\n                </div>\n                <div className=\"block_custom_field\">\n                    <div className=\"block_field\">\n                        <div className=\"password_reset\">\n                            <span>Password</span>\n                            <Link to={`/auth/password-recovery/first-step`}>Forgot password?</Link>\n                        </div>\n                        <Field name=\"password\"\n                               type=\"password\"\n                               component={RenderField}\n                               placeholder=\"Type here…\"\n                               onChange={(e) => (error_login ? resetErrorUsers() : e)}\n                        />\n                        <span className='back_error'>{!!error_login && error_login.password}</span>\n                    </div>\n                    <div className=\"captcha_block\">\n                        <ReCAPTCHA\n                            theme=\"light\"\n                            ref={recaptchaRef}\n                            sitekey={SITE_KEY}\n                            onChange={this.onChange}\n                        />\n                        <span className='back_error'>{!!error_login && error_login.recaptcha}</span>\n                    </div>\n                </div>\n                <div className=\"auth_btn_wrapper\">\n                    <DefaultButton\n                        variant=\"contained\"\n                        disabled={reCaptcha ? submitting || pristine || !valid : true}\n                        loading={loading}\n                        formAction\n                        type=\"submit\"\n                    >\n                        Sign in\n                    </DefaultButton>\n                </div>\n                <div className=\"info_auth\">\n                    <span>Don’t have a VIEBEG account yet?</span>\n                    <Link to={`/auth/sign-up`}>\n                        SIGN UP\n                    </Link>\n                </div>\n            </form>\n        );\n    }\n}\n\nconst validate = values => {\n    const errors = {};\n    if (!values.company) {\n        errors.company = 'Required'\n    } else if (values.company.length < 3) {\n        errors.company = 'Must be 3 characters or more'\n    }\n    if (!values.email) {\n        errors.email = 'Required'\n    } else if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,5}$/i.test(values.email)) {\n        errors.email = 'Invalid email'\n    }\n    if (!values.password) {\n        errors.password = 'Required'\n    } else if (values.password.length < 8) {\n        errors.password = 'Must be 8 characters or more'\n    }\n    if (!values.phone) {\n        errors.phone = 'Required'\n    }\n    if (!values.address) {\n        errors.address = 'Required'\n    }\n    return errors\n};\n\nLogin = reduxForm({\n    form: 'LoginForm',\n    validate\n})(Login);\n\nfunction  mapStateToProps(state, props) {\n    return{\n        error_login: state.auth.error,\n    }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return bindActionCreators({\n        postLogin,\n        resetErrorUsers\n    }, dispatch);\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Login);"]},"metadata":{},"sourceType":"module"}